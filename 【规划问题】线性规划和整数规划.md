# 【规划问题】线性规划和整数规划

个人之前是没接触过太多规划问题，在听完课程和查阅资料之后，才知道这部分是属于运筹学的数学规划范畴。整理资料后，打算简述下规划问题中的线性规划和整数规划问题。

## 1. 数学规划

**表达形式**

数学规划问题的一般形式是：$\max(min)f(x),s.t.x \in X$，其中x是一个n维向量，也称决策变量；X是一个集合，可以说简单区域，也可以用一系列等式和不等式甚至其他形式表示，称为可行集。

**应用场景**

吉尼斯世界纪录，总理的政府工作报告，公司的领导的核心工作，如何使用好自己的钱，树木的生长问题，群狼的捕猎计划，行星的运行轨道，原子的内部结构等等。

**分类**

根据问题的结构，可以进行下面的一些分类

（1）线性规划：目标函数和约束是线性的

（2）非线性规划：目标函数或约束是非线性的

（3）整数规划：决策变量是离散的，只能取整数值

（4）多目标规划：目标函数有多个

（5）……

线性规划：最简单、最广泛使用。George B. Dantzig， 1947年线性规划单纯型算法

非线性规划：更多的应用背景。1951年Kuhn和Tucker，最优性条件。

整数规划：最富于挑战、回归本源。 1958年R.E.戈莫里，割平面法

多目标规划：人性多样化要求。1896年法国经济学家 V.帕累托提出多样化思想。

## 2. 线性规划

线性规划的定义是，一个根据如下规则的优化问题：

1. 我们尝试最大化或者最小化一个决策变量的线性方程。这个被最大化或者最小化的方程叫目标方程。
2. 决策变量的值必须满足一组约束条件。每个约束条件必须是一个线性等式或者线性不等式。
3. 一个符号限制是和每一个变量都有联系的。对任意变量$x_i$，这个符号限制指定了$x_i$必须非负或者在不受符号约束。

求解线性规划问题的基本方法是单纯形法，后来又有改进单纯形法、对偶单纯形法等。



举例：动物饲养问题

一家现代化兔子饲养场饲养一种兔子。根据兔子在不同时期的体重计算出兔子每周营养物质的数量。简单起见，这里考虑三种对生长其重要作用的营养成分，蛋白质、矿物质和维生素。

**蛋白质：70克**

**矿物质：3克**

**维生素：10毫克**

现有五种饲料，公司希望找出满足动物营养需要使成本达到最低的混合饲料配置。



**每一种饲料每斤所含的营养成分**

![preview](https://pic1.zhimg.com/v2-d97fc6b71b1aaa0a28bda8711518d840_r.jpg)

① 决策变量：在混合饲料中，每周所需第j种饲料的斤数$x_j，j= 1，2，3，4，5$；

② 约束条件：

- 蛋白质：$0.30\times x_1+2\times x_2+x_3+0.6\times x_4+1.8\times x_5≥70$

- 矿物质：$0.10\times x_1+0.05\times x_2+0.02\times x_3+0.2\times x_4+0.05\times x_5≥3$

- 维生素：$0.05\times x_1+0.1\times x_2+0.02\times x_3+0.2\times x_4+0.08\times x_5≥10$

- 非负约束：$x_i≥0$

③ 确定目标：混合饲料的成本最低
$$
0.02\times x_1+0.07\times x_2+0.04\times x_3+0.03\times x_4+0.05\times x_5→min
$$
线性规划模型：
$$
\min 0.02\times x_1+0.07\times x_2+0.04\times x_3+0.03\times x_4+0.05\times x_5
$$
s.t.
$$
\begin{array}{c} 
0.30\times x_1+2\times x_2+x_3+0.6\times x_4+1.8\times x_5≥70\\
0.10\times x_1+0.05\times x_2+0.02\times x_3+0.2\times x_4+0.05\times x_5≥3\\
0.05\times x_1+0.1\times x_2+0.02\times x_3+0.2\times x_4+0.08\times x_5≥10\\
x_j≥0,j = 1,2,3,4,5;
\end{array}
$$


## 3. 整数规划

全部变量限制为整数的规划问题，称为纯整数规划；部分变量限制为整数的规划问题，称为混合整数规划；变量只取0或1的规划问题，称为0-1整数规划。

常用的整数规划问题解法有：

（1）分枝定界法：可求纯或混合整数线性规划。

（2）割平面法：可求纯或混合整数线性规划。

（3）隐枚举法：用于求解0-1整数规划，有过滤法和分枝法。

（4）匈牙利法：解决指派问题（0-1规划特殊情形）。

（5）蒙特卡罗法：求解各种类型规划。

**分支定界法**

分支定界法的基本思想是：设有最大化的整数规划问题A，先解与之相应的线性规划问题B，若B的最优解不符合A的整数条件，那么B的最优目标函数必是A的最优目标函数$z^*$的上界，记作$z_2$, 而A的任意可行解的目标函数值将是$z^*$的一个下界$z_1$, 分支定界法就是将B的可行域分成子区域（称为分支）的方法，逐步减小$z_2$和增大$z_1$，最终求到$z^*$。

**0-1整数规划**

变量$x_i$只能取值$0,1$, 该约束条件可表示为：
$$
0\le x\le 1, x_i \in \mathbb{N}, x_i(x_i-1)=0
$$
隐枚举法：

用约束条件来枚举，最终求得问题最优解。

蒙特卡洛法：

整数规划由于限制变量是整数，增加了求解难度，但整数解是有限个，所以可以采用枚举法。当枚举个数很多时，显性枚举是不现实的，但利用蒙特卡罗随机取样法，在一定的计算量下是可以得到满意解的。

## 4. 可用于解规划问题的python包

课上介绍了两个python libraries可以求解规划问题，分别是pulp和ortools。其中pulp只用于线性模型，包括如整数规划、01规划，还是混合整数线性规划 MILP。ortools可以解决车辆路径、流程、整数和线性规划等问题，并且提供了C++,Python,Java,.NET接口，泛用性较广。

**Ortools求解步骤**

1. solver创建

   ```python
   solver = pywraplp.Solver.CreateSolver('SCIP')
   ```

2. 变量设置

   ```python
   solver.NumVar：创建普通变量
   solver.IntVar：创建整数变量
   
   infinity = solver.infinity() # 正无穷
   x = solver.IntVar(0.0, infinity, 'x')
   print('变量数量：', solver.NumVariables())
   ```

3. 添加约束条件

   ```python
   solver.Add(x + 7 * y <= 17.5)
   print('约束的数量：', solver.NumConstraints())
   ```

4. solve求解

   ```python
   # 求解最大值问题
   solver.Maximize(x + 10 * y)
   status = solver.Solve()
   ```

5. solve结果

   ```pyth
   print('目标值 =', solver.Objective().Value())
   print('x =', x.solution_value())
   print('y =', y.solution_value())
   ```

   





**参考资料**：

1. https://zhuanlan.zhihu.com/p/199197676
2. https://zhuanlan.zhihu.com/p/27976866